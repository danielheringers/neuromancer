# AlicIA - Pacote de PR (MVP-018, MVP-019, MVP-020)

Data de referencia: 2026-02-18
Branch atual: `neuromancer`

## Escopo consolidado
1. `ALICIA-MVP-018`:
- workflow cross-platform `alicia-ci` com jobs:
  - `suite_minima`
  - `policy_approval_scenarios`
  - `e2e_flow`
2. `ALICIA-MVP-019`:
- testes E2E do fluxo principal (caso feliz, negacao/expiracao e cancelamento seguro) no `codex-alicia-ui`.
3. `ALICIA-MVP-020`:
- guia operacional de instalacao (3 SO), troubleshooting e checklist pre-release.

## Arquivos-chave
1. `.github/workflows/alicia-ci.yml`
2. `codex-rs/alicia-ui/tests/e2e_flow.rs`
3. `codex-rs/alicia-ui/src/lib.rs`
4. `codex-rs/alicia-ui/Cargo.toml`
5. `Alicia/12-guia-mvp-instalacao-troubleshooting-checklist.md`
6. `Alicia/07-plano-release-oss.md`

## Evidencias locais ja validadas
1. `cargo test -p codex-alicia-core -p codex-alicia-adapters -p codex-alicia-ui`
2. `cargo test -p codex-alicia-ui e2e_happy_path_approval_execution_and_audit -- --exact`
3. `cargo test -p codex-alicia-ui e2e_denied_and_expired_blocked_audit -- --exact`
4. `cargo test -p codex-alicia-ui e2e_safe_cancel_persists_final_audit_state -- --exact`
5. `cargo fmt -- --config imports_granularity=Item`
6. `cargo clippy --fix --all-features --tests --allow-dirty -p codex-alicia-ui`

## Evidencias GitHub e smoke (2026-02-18)
1. Workflow run: `https://github.com/danielheringers/neuromancer/actions/runs/22125554135`
2. Commit validado: `9aff164e48a37d195780eabed67e8035fe37ea8a`
3. Jobs `suite_minima`:
- `windows-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711382`)
- `macos-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711396`)
- `ubuntu-latest`: failure (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711407`)
4. Jobs `policy_approval_scenarios`:
- `windows-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711454`)
- `macos-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711391`)
- `ubuntu-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711394`)
5. Jobs `e2e_flow`:
- `windows-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711395`)
- `macos-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711393`)
- `ubuntu-latest`: success (`https://github.com/danielheringers/neuromancer/actions/runs/22125554135/job/63954711390`)
6. Smoke manual launcher (local):
- Comando:
```powershell
cargo run -p codex-alicia-ui --bin codex-alicia-ui-app -- --session-id smoke-20260218 --audit-path ./.codex/alicia-smoke-audit.jsonl -- cmd /C echo ALICIA_AUDIT_OK
```
- Saida relevante:
  - `Sessao iniciada: smoke-20260218`
  - `ALICIA_AUDIT_OK`
  - `Sessao finalizada (exit_code=0, duration_ms=22).`
- JSONL gerado em `codex-rs/.codex/alicia-smoke-audit.jsonl`:
```json
{"timestamp":1771386306,"session_id":"smoke-20260218","action_kind":"execute_command","target":"cmd /C echo ALICIA_AUDIT_OK","profile":"full_access","policy_decision":"allow","approval_decision":"not_required","result_status":"succeeded","duration_ms":22}
```

## Passos para fechamento do PR

### 1) Revisar diff e preparar commit
```bash
git status --short
git add .github/workflows/alicia-ci.yml Alicia/07-plano-release-oss.md Alicia/12-guia-mvp-instalacao-troubleshooting-checklist.md Alicia/13-pr-mvp-018-020.md codex-rs/alicia-ui/Cargo.toml codex-rs/alicia-ui/src/lib.rs codex-rs/alicia-ui/tests/e2e_flow.rs codex-rs/Cargo.toml codex-rs/Cargo.lock
git commit -m "alicia: add cross-platform CI, e2e flow tests, and MVP release docs"
```

### 2) Push para branch remoto
```bash
git push origin neuromancer
```

### 3) Abrir PR no GitHub (manual)
1. Base: `main`
2. Compare: `neuromancer`
3. Titulo sugerido:
- `AlicIA MVP-018/019/020: cross-platform CI, E2E flow, release docs`
4. Descricao sugerida:
- incluir escopo, evidencias locais e criterio de aceite dos tres itens.

### 4) Disparar e validar workflow `alicia-ci`
1. Verificar jobs por plataforma:
- `Alicia Suite Minima - ubuntu/macos/windows`
- `Alicia Policy and Approval Scenarios - ubuntu/macos/windows`
- `Alicia E2E Flow - ubuntu/macos/windows`
2. Confirmar os 9 jobs verdes.
3. Anexar links/prints no corpo do PR.

## Definicao de pronto para merge
1. PR revisado e aprovado.
2. `alicia-ci` verde nos 3 SO.
3. Checklist do `Alicia/12-guia-mvp-instalacao-troubleshooting-checklist.md` marcado para release candidata.

## Status atual de fechamento
1. `ALICIA-MVP-019` e smoke local: evidenciados.
2. `ALICIA-MVP-018`: validado com `alicia-ci` 9/9 verde no PR atual.
3. `ALICIA-MVP-020`: documentacao atualizada com comandos e smoke.
4. Validacao de adapters com binarios reais (ciclo seguinte):
- `codex` presente no host e respondendo `codex-cli 0.101.0` em `--version`.
- `codex-cli` dedicado e `claude-code` nao encontrados no host atual.
- Risco residual: falta validar fluxo real do adapter `claude-code` ate instalar o binario.

## Revalidacao CI apos correcao (2026-02-18)
1. Commit de correcao: `9e85c3b4a243fe84f5dd253cf261efecfc6dbde2`
2. Workflow run: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223`
3. Resultado final: `success` (9/9 jobs verdes)
4. Jobs por matriz:
- `Alicia Suite Minima - ubuntu-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370912`
- `Alicia Suite Minima - macos-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370860`
- `Alicia Suite Minima - windows-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370920`
- `Alicia Policy and Approval Scenarios - ubuntu-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370889`
- `Alicia Policy and Approval Scenarios - macos-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370877`
- `Alicia Policy and Approval Scenarios - windows-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370900`
- `Alicia E2E Flow - ubuntu-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370947`
- `Alicia E2E Flow - macos-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370903`
- `Alicia E2E Flow - windows-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22135313223/job/63985370906`

## Smoke adicional apos correcao (2026-02-18)
1. Comando executado:
```powershell
cargo run -p codex-alicia-ui --bin codex-alicia-ui-app -- --session-id smoke-20260218-b --audit-path ./.codex/alicia-smoke-audit-2.jsonl -- cmd /C echo ALICIA_AUDIT_OK_2
```
2. Saida relevante:
- `Sessao iniciada: smoke-20260218-b`
- `ALICIA_AUDIT_OK_2`
- `Sessao finalizada (exit_code=0, duration_ms=14).`
3. JSONL gerado:
```json
{"timestamp":1771409873,"session_id":"smoke-20260218-b","action_kind":"execute_command","target":"cmd /C echo ALICIA_AUDIT_OK_2","profile":"full_access","policy_decision":"allow","approval_decision":"not_required","result_status":"succeeded","duration_ms":14}
```

## Estado de PR no GitHub
1. PR aberto: `https://github.com/danielheringers/neuromancer/pull/13`
2. Base: `main`
3. Head: `neuromancer`
4. Commit da rodada atual: `7f5064040e4f8c0d0c65d031e5e8e4262905148d`

## Validacao de adapters com binarios reais (ciclo tecnico)
1. `codex` disponivel no host e validado com:
- `codex --version` -> `codex-cli 0.101.0`
- `codex exec --help` -> retorno `0` com help completo
2. `claude-code` nao encontrado no host atual (`command not found`), mantendo risco residual desse provider.

## Execucao complementar apos sync (2026-02-18)
1. Branch `neuromancer` sincronizado com `main` e atualizado no remoto:
- merge de sync: `82e74ffd89918aa4cbd9fdf448fa6799102aaecf`
2. Ajuste de compatibilidade necessario para manter o build apos sync:
- commit: `d1e084a6a94990a5971bb94c01a4028bb8cb8447`
- arquivo: `codex-rs/protocol/src/thread_id.rs`
- motivo: API do `schemars` `1.2.x` (imports e assinatura de `schema_name`).
3. Regressao local executada apos o sync:
- `cargo test -p codex-alicia-core -p codex-alicia-adapters -p codex-alicia-ui` -> success
- `cargo test -p codex-protocol` -> success
4. Smoke manual adicional (`codex-alicia-ui-app`) apos sync:
- comando:
```powershell
cargo run -p codex-alicia-ui --bin codex-alicia-ui-app -- --session-id smoke-20260218-sync --audit-path ./.codex/alicia-smoke-audit-sync.jsonl -- cmd /C echo ALICIA_AUDIT_SYNC_OK
```
- saida relevante:
  - `Sessao iniciada: smoke-20260218-sync`
  - `ALICIA_AUDIT_SYNC_OK`
  - `Sessao finalizada (exit_code=0, duration_ms=13).`
- JSONL:
```json
{"timestamp":1771410962,"session_id":"smoke-20260218-sync","action_kind":"execute_command","target":"cmd /C echo ALICIA_AUDIT_SYNC_OK","profile":"full_access","policy_decision":"allow","approval_decision":"not_required","result_status":"succeeded","duration_ms":13}
```
5. CI complementar disparada para o commit de sync/fix:
- workflow: `https://github.com/danielheringers/neuromancer/actions/runs/22136388040`
- run_number: `14`
- status no momento do registro: `queued` (fila de runners do reposit√≥rio).

## Revalidacao no PR atual (2026-02-18)
1. Workflow run (`pull_request`): `https://github.com/danielheringers/neuromancer/actions/runs/22139722352`
2. Run number: `16`
3. Resultado final: `success` (9/9 jobs verdes)
4. Jobs por matriz:
- `Alicia Policy and Approval Scenarios - windows-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552234`
- `Alicia E2E Flow - macos-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552256`
- `Alicia E2E Flow - windows-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552257`
- `Alicia Policy and Approval Scenarios - ubuntu-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552265`
- `Alicia Suite Minima - ubuntu-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552266`
- `Alicia E2E Flow - ubuntu-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552268`
- `Alicia Suite Minima - macos-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552280`
- `Alicia Policy and Approval Scenarios - macos-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552296`
- `Alicia Suite Minima - windows-latest`: `https://github.com/danielheringers/neuromancer/actions/runs/22139722352/job/64000552310`
5. Status de risco de adapter:
- `claude-code --version` no host atual retorna `command not found`.
- risco residual mantido: validar provider em host com binario real antes de release final.
